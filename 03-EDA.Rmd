# Estadísticos descriptivos del Abandono Escolar

Empezaremos este ejercicio dividiendo nuestra encuesta, en dos set de datos uno para el entrenamiento y otro para la prueba, por ese motivo decidimos separa la base usando un muestreo estratificado debido a que las muestra no es balanceada.

Decidimos guardar **20%** como datos de prueba, siendo **2,464** y usar el restante **9,853** como datos de entrenamiento, de estos usar el **20%** de los datos de entrenamiento para hacer validación, quedando como sigue:

|Division|Total|Porcentaje|
|---|---|---|
|Prueba|2,464|20%|
|Entrenamiento|9,853|80%|
|Total|12,317|100%|

Posteriormente la muestra de entrenamiento se subdivide, para crear espacio para la muestra de validación.

|Division|Total|Porcentaje|
|---|---|---|
|Entrenamiento|7,882|80%|
|Validación |1,971|20%|
|Total |9,853|100%|
<7882/1971/9853>


```{r}
set.seed(2021)


encuesta_part_inicial <- initial_split(encuesta, strata = desertor, prop = 0.80)
encuesta_total <- training(encuesta_part_inicial)
encuesta_part_val <- validation_split(encuesta_total, prop = 0.80)
encuesta_part_val$splits


```

## Limpieza, exploración y análisis conceptual

Primero vamos a establecer que la variable desertor es la que estamos buscando, esta toma dos valores, 1 si el estudiante desertó y 0 si no lo hizo.

Podemos observar que se cuenta con $32%$ de desertores y $68%$ no desertores en la encuesta.
 

```{r}
set.seed(2021)
entrena <- training(encuesta_part_val$splits[[1]])
nrow(entrena)
entrena%>% count(desertor) %>%
  mutate(pcn = round(n / sum(n),2))
```

## Resumen general

```{r}
library(skimr)

skim(entrena)

```

### ¿El género influye?

En la siguiente tabla puede ver que parecen ser números muy similares, es decir, se observa que mientras el $43\%$ de los hombres desertan, el $41\%$ de las mujeres lo hacen.

Incluso pensaría que el porcentaje de mujeres que sería superior pero los datos indican lo cotrario, la tasa de deserción de mujeres es ligeramente menor que la de los hombres.

```{r}
entrena %>% select(sexo, desertor) %>% 
  group_by(sexo, desertor) %>% 
  tally() %>% mutate(pcn = round(n/sum(n),2))

```


##  Variables claramente importantes (hipótesis):


- Sexo 
- Promedio en la secundaria (p5)
- Tipo de secundaria a la que asistió (p6)
- Te cambiaste de escuela (p7)
- En qué tipo de institución estudiaste (p8)
- Cuanto tiempo haces a la escuela (p10)
- ¿Con quien vives? (P12_1:P12_10)
- ¿Que tanto asistes a tus clases? (p14)
- Tener hijos
- Consumo de Drogas

### Promedio Secundaria

```{r}
tabla_univariada <- function(datos, variable, target){
  datos %>% count({{ variable }}, {{ target }}) %>% group_by({{ variable }}) %>% 
  mutate(pcn = round(n / sum(n),2)) }

tabla_univariada(entrena, prom_sec, desertor) %>%
  ggplot(aes(prom_sec, pcn, fill = desertor)) + 
  geom_col(position = "dodge") + ggtitle("Promedio Secundaria")


entrena %>% select(sexo, desertor,   prom_sec ) %>% group_by(sexo, desertor) %>%
  ggplot(aes(prom_sec, sexo, fill = desertor)) + 
  geom_boxplot() + ggtitle("Promedio Secundaria")
```
### Pública o Privada

Se observa que si la educación es privada la probabilidad de deserción es $36\%$, mientras que si es pública es $42\%$.

```{r}

tabla_univariada(entrena, sec_publica, desertor) %>%
  ggplot(aes(sec_publica, pcn, fill = desertor)) + 
  geom_col(position = "dodge") + ggtitle("Tipo de Secundaria a la que asistió")
```



#### ¿Con quien vives? (P12_1:P12_10)

```{r}
tabla_univariada(entrena, p12_1, desertor) %>%
  ggplot(aes(p12_1, pcn, fill = desertor)) + 
  geom_col(position = "dodge") + ggtitle("¿Vives solo?")

```

```{r}

tabla_univariada(entrena, p12_8, desertor)  %>%
  ggplot(aes(p12_8, pcn, fill = desertor)) + 
  geom_col(position = "dodge") +  ggtitle("¿Vives con tus hijos?")

tabla_univariada(entrena, p12_9, desertor)  %>%
  ggplot(aes(p12_9, pcn, fill = desertor)) + 
  geom_col(position = "dodge") +  ggtitle("¿Vives con esposo(a) o pareja?")
```
##### ¿Si eres mujer y vives con tus hijo es lo mismo que si eres hombre?

```{r}
entrena %>% select(sexo, p12_9, desertor) %>% 
  filter(sexo == " Mujer") %>% group_by(p12_9, desertor) %>% tally() %>% mutate(pcn = round(n/sum(n),2)) %>%
  ggplot(aes(p12_9, pcn, fill = desertor)) + 
  geom_col(position = "dodge") +  ggtitle("Mujer: ¿Vives con tus hijos?")
```

```{r}
entrena %>% select(sexo, p12_9, desertor) %>% 
  filter(sexo == " Hombre") %>% group_by(p12_9, desertor) %>% tally() %>% mutate(pcn = round(n/sum(n),2)) %>%
  ggplot(aes(p12_9, pcn, fill = desertor)) + 
  geom_col(position = "dodge") +  ggtitle("Hombre: ¿Vives con tus hijos?")
```

#### ¿Qué tanto asistias a tus clases?

```{r}
tabla_univariada(entrena, asistencia, desertor) %>% 
  ggplot(aes(asistencia, pcn, fill = desertor)) + 
  geom_col(position = "dodge") +  ggtitle("¿Qué tanto faltabas a clase?") +
  scale_x_discrete(guide = ggplot2::guide_axis(n.dodge = 2), 
                     labels = function(x) stringr::str_wrap(x, width = 20)) + xlab("")

```

```{r}
tabla_univariada(entrena, edo, desertor) %>%   
   ggplot(aes(edo, pcn, fill = desertor) + 
  geom_col(position = "stack") +  ggtitle("¿Deserciones por entidad?") +
  theme(axis.text.x = element_text(angle = 90))
```




